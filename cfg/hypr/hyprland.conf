# Please note not all available settings / options are set here.
# For a full list, see the wiki https://wiki.hypr.land
$qsConfig = ii

# Source a file (multi-file configs)
source = colors.conf
source = keybinds.conf
source = monitors.conf
source = workspaces.conf
source = custom.conf

#-----------------------------------------------------------------------#

# █▀ ▀█▀ ▄▀█ █▀█ ▀█▀ █░█ █▀█
# ▄█ ░█░ █▀█ █▀▄ ░█░ █▄█ █▀▀

exec-once = qs -c $qsConfig &
exec-once = hypridle

# Required at launch
exec-once = dbus-update-activation-environment --all
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = gnome-keyring-daemon --start --components=secrets

# Set wallpaper and restore colors
exec-once = wpgtk --restore

# Input method
exec-once = fcitx5

exec-once = pkill fusuma; fusuma -d

# Clipboard managers
exec-once = wl-paste --type text --watch bash -c 'cliphist store && qs -c $qsConfig ipc call cliphistService update'
exec-once = wl-paste --type image --watch bash -c 'cliphist store && qs -c $qsConfig ipc call cliphistService update'

exec-once = wl-clip-persist --clipboard regular

# Optional
exec-once = playerctld daemon
exec-once = kdeconnectd

#-----------------------------------------------------------------------#

# █▀▀ █▄░█ █░█
# ██▄ █░▀█ ▀▄▀

# ######### Input method ##########
# See https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland
env = QT_IM_MODULE, fcitx
env = XMODIFIERS, @im=fcitx
env = SDL_IM_MODULE, fcitx
env = GLFW_IM_MODULE, ibus
env = INPUT_METHOD, fcitx

# Some default env vars.
env = QT_QPA_PLATFORM, wayland
env = QT_QPA_PLATFORMTHEME, qt5ct
env = QT_AUTO_SCREEN_SCALE_FACTOR, 1
env = QT_WAYLAND_DISABLE_WINDOWDECORATION, 1

env = ELECTRON_OZONE_PLATFORM_HINT,auto

#env = WLR_NO_HARDWARE_CURSORS,1

#env = LIBVA_DRIVER_NAME,nvidia
#env = GBM_BACKEND,nvidia-drm
#env = __GLX_VENDOR_LIBRARY_NAME,nvidia

#-----------------------------------------------------------------------#

# █ █▄░█ █▀█ █░█ ▀█▀
# █ █░▀█ █▀▀ █▄█ ░█░

input {
	kb_layout = us
	kb_variant =
	kb_options =
	kb_rules =
	numlock_by_default = true
	repeat_delay = 250
	repeat_rate = 35
	
	follow_mouse = 1
	off_window_axis_events = 2
	
	sensitivity = 0.5
	accel_profile = flat
	special_fallthrough = true

	touchpad {
		disable_while_typing = true
		natural_scroll = no
		clickfinger_behavior = true
		middle_button_emulation = true
		tap-to-click = true
		scroll_factor = 0.5
	}
	
}

gestures {
	workspace_swipe_use_r = true
	workspace_swipe_invert = false
	workspace_swipe_forever = false
	workspace_swipe_create_new = true
	workspace_swipe_direction_lock = false
	workspace_swipe_min_speed_to_force = 30
}

#-----------------------------------------------------------------------#

# █▀▀ █▀▀ █▄░█ █▀▀ █▀█ ▄▀█ █░░
# █▄█ ██▄ █░▀█ ██▄ █▀▄ █▀█ █▄▄

general {
	# See https://wiki.hypr.land/Configuring/Variables/ for more
	gaps_in = 5
	gaps_out = 8
	border_size = 3
	col.active_border = $green $cyan 45deg
	col.inactive_border = $magenta $yellow 60deg
	
	allow_tearing = true
	
	resize_on_border = 1
	
	layout = dwindle

	snap {
		enabled = true
		window_gap = 15
		monitor_gap = 15
		border_overlap = false
		respect_gaps = true
	}
}

group{
	auto_group = true
	insert_after_current = true
	focus_removed_window = true
	drag_into_group = 1
	merge_groups_on_drag = true
	merge_groups_on_groupbar = true
	merge_floated_into_tiled_on_groupbar = false
	group_on_movetoworkspace = false
	col.border_active = $magenta $yellow 60deg
	col.border_inactive = $blue $cyan 90deg
	col.border_locked_active = $blue $cyan 45deg
	col.border_locked_inactive = $blue $cyan 45deg
	
	groupbar{
		enabled = true
		font_family = JetBrains Mono Medium
		font_size = 14
		font_weight_active = Normal
		font_weight_inactive = Normal
		gradients = true
		height = 18
		indicator_gap = 0
		indicator_height = 0
		stacked = false
		priority = 3
		render_titles = true
		text_offset = 0
		scrolling = true
		rounding = 5
		gradient_rounding = 2
		round_only_edges = true
		gradient_round_only_edges = true
		render_titles= true
		text_color = $white
		col.active = $magenta
		col.inactive = $red
		gaps_in = 2
		gaps_out = 2
		keep_upper_gap = true
	}
}

# Layouts
dwindle {
	# See https://wiki.hypr.land/Configuring/Dwindle-Layout/ for more
	# enable pseudotiling on dwindle
	pseudotile = true
	force_split = 2
	preserve_split = true
	use_active_for_splits = true    
	special_scale_factor = 0.8
}

#-----------------------------------------------------------------------#

# █▀▄ █▀▀ █▀▀ █▀█ █▀█ ▄▀█ ▀█▀ █ █▀█ █▄░█
# █▄▀ ██▄ █▄▄ █▄█ █▀▄ █▀█ ░█░ █ █▄█ █░▀█

decoration {
	# See https://wiki.hypr.land/Configuring/Variables/ for more
	
    rounding = 12

	# Your blur "amount" is blur_size * blur_passes, but high blur_size (over around 5-ish) will produce artifacts.
	# if you want heavy blur, you need to up the blur_passes.
	# the more passes, the more you can up the blur_size without noticing artifacts.   
	blur {
		enabled = true
		size = 8
		passes = 2
		xray = false
		#ignore_opacity = true
		new_optimizations = true
		noise = 0.0117
		contrast = 0.8916
		brightness = 0.8172
		vibrancy = 0.1696
		vibrancy_darkness = 0.0
		special = false
		popups = false
		popups_ignorealpha = 0.2
	}

	# Shadow
	shadow {
		enabled = false
        ignore_window = false
        range = 30
        offset = 0 2
        render_power = 4
		offset = 0 2
		scale = 1.0
		color = $black
	}

	# Dim
	dim_inactive = false
	dim_strength = 0.5
	dim_special  = 0
	
# Blurring layerSurfaces (UI components like bars, application launchers, etc)
# Rofi
#layerrule = match:namespace:^(rofi)$, blur on
layerrule = match:namespace ^(rofi)$, ignore_alpha 0.1

# GTK layer-shell surfaces (bars, panels, launchers)
layerrule = match:namespace ^(gtk-layer-shell)$, blur 1

# Hyprpicker
layerrule = match:namespace ^(hyprpicker)$, no_anim 1

# Launchers need to be FAST
layerrule = match:namespace gtk4-layer-shell, no_anim 1
	
# Quickshell
layerrule = match:namespace quickshell:.*, blur_popups on
layerrule = match:namespace quickshell:.*, blur on
layerrule = match:namespace quickshell:.*, ignore_alpha 0.7
layerrule = match:namespace quickshell:bar, animation slide
layerrule = match:namespace quickshell:actionCenter, no_anim on
layerrule = match:namespace quickshell:cheatsheet, animation slide bottom
layerrule = match:namespace quickshell:dock, animation slide bottom
layerrule = match:namespace quickshell:screenCorners, animation popin 120%
layerrule = match:namespace quickshell:lockWindowPusher, no_anim on
layerrule = match:namespace quickshell:notificationPopup, animation fade
layerrule = match:namespace quickshell:overlay, no_anim on
layerrule = match:namespace quickshell:overlay, ignore_alpha 1
layerrule = match:namespace quickshell:overview, no_anim on
layerrule = match:namespace quickshell:osk, animation slide bottom
layerrule = match:namespace quickshell:polkit, no_anim on
layerrule = match:namespace quickshell:popup, xray off # No weird color for bar tooltips (this in theory should suffice)
layerrule = match:namespace quickshell:popup, ignore_alpha 1 # No weird color for bar tooltips (but somehow this is necessary)
layerrule = match:namespace quickshell:mediaControls, ignore_alpha 1 # Same as above
layerrule = match:namespace quickshell:reloadPopup, animation slide
layerrule = match:namespace quickshell:regionSelector, no_anim on
layerrule = match:namespace quickshell:screenshot, no_anim on
layerrule = match:namespace quickshell:session, blur on
layerrule = match:namespace quickshell:session, no_anim on
layerrule = match:namespace quickshell:session, ignore_alpha 0
layerrule = match:namespace quickshell:sidebarRight, animation slide right
layerrule = match:namespace quickshell:sidebarLeft, animation slide left
layerrule = match:namespace quickshell:verticalBar, animation slide
layerrule = match:namespace quickshell:wallpaperSelector, animation slide top
layerrule = match:namespace quickshell:wNotificationCenter, no_anim on
layerrule = match:namespace quickshell:wOnScreenDisplay, no_anim on
layerrule = match:namespace quickshell:wStartMenu, no_anim on
layerrule = match:namespace quickshell:wTaskView, ignore_alpha 0
layerrule = match:namespace quickshell:wTaskView, no_anim on

# Launchers need to be FAST
layerrule = match:namespace gtk4-layer-shell, no_anim on
}

#-----------------------------------------------------------------------#

# ▄▀█ █▄░█ █ █▀▄▀█ ▄▀█ ▀█▀ █ █▀█ █▄░█ █▀
# █▀█ █░▀█ █ █░▀░█ █▀█ ░█░ █ █▄█ █░▀█ ▄█

animations {
	enabled = true
	# Animation curves
	bezier = linear, 0, 0, 1, 1
	bezier = md3_standard, 0.2, 0, 0, 1
	bezier = md3_decel, 0.05, 0.7, 0.1, 1
	bezier = md3_accel, 0.3, 0, 0.8, 0.15
	bezier = menu_decel, 0.1, 1, 0, 1
	bezier = menu_accel, 0.38, 0.04, 1, 0.07
	bezier = overshot, 0.05, 0.9, 0.1, 1.1
	bezier = crazyshot, 0.1, 1.5, 0.76, 0.92 
	bezier = hyprnostretch, 0.05, 0.9, 0.1, 1.0
	bezier = fluent_decel, 0.1, 1, 0, 1
	bezier = easeInOutCirc, 0.85, 0, 0.15, 1
	bezier = easeOutCirc, 0, 0.55, 0.45, 1
	bezier = easeOutExpo, 0.16, 1, 0.3, 1
	
	# Animation configs
	animation = windows, 1, 3, md3_decel, popin 60%
	animation = windowsIn, 1, 3, md3_decel, popin 60%
	animation = windowsOut, 1, 3, md3_accel, popin 60%
	
	animation = border, 1, 10, default
	animation = fade, 1, 2.5, md3_decel
	animation = workspaces, 1, 7, fluent_decel, slidevert
	animation = specialWorkspace, 1, 3, md3_decel, slidevert
	
	animation = layersIn, 1, 3, menu_decel, slide 10%
	animation = layersOut, 1, 1.6, menu_accel, slide 10%
	animation = fadeLayersIn, 1, 3, menu_decel
	animation = fadeLayersOut, 1, 1.6, menu_accel
}

# Misc
misc {
	disable_hyprland_logo = true
	disable_splash_rendering = true
	focus_on_activate = true
	allow_session_lock_restore = true
	initial_workspace_tracking = true
	mouse_move_enables_dpms = true
	key_press_enables_dpms = true
	close_special_on_empty = true
	vfr = true
	vrr = true
	middle_click_paste = true
	#new_window_takes_over_fullscreen = 2
	enable_swallow = false
	session_lock_xray = true
	animate_manual_resizes = false
	animate_mouse_windowdragging = false
}

cursor {
	zoom_factor = 1.0
	zoom_rigid = false
	no_hardware_cursors = false
	min_refresh_rate = 24
	hotspot_padding = 1
	inactive_timeout = 0
}

binds {
	allow_workspace_cycles = true
	allow_pin_fullscreen = true
	scroll_event_delay = 0
	hide_special_on_workspace_change = false
}

ecosystem {
	no_update_news = true
	no_donation_nag = true
	enforce_permissions = false
}

debug {
	disable_logs = false
}

#-----------------------------------------------------------------------#

# █░█░█ █ █▄░█ █▀▄ █▀█ █░█░█   █▀█ █░█ █░░ █▀▀ █▀
# ▀▄▀▄▀ █ █░▀█ █▄▀ █▄█ ▀▄▀▄▀   █▀▄ █▄█ █▄▄ ██▄ ▄█

# Example windowrule v1
# windowrule = float, ^(kitty)$
# Example windowrule v2
# windowrule = float,class:^(kitty)$,title ^(kitty)$
# See https://wiki.hypr.land/Configuring/Window-Rules/ for more
# windowrule = tile, class:^(Spotify)$

# Float Rules
windowrule = match:class ^(org.*|com.*|app.*|io.*|nwg-*)$, float on
windowrule = match:title ^(Open File)(.*)$, center on

windowrule = match:class ^(notification|error|splash|feh|mpv|eog|wpg|dialog|confirm)$, float 1
windowrule = match:class ^(file_progress|viewnior|confirmreset|steam|waypaper|xarchiver)$, float 1
windowrule = match:class ^(nm-connection-editor|yad|xdg-desktop-portal-gtk|papers-previewer)$, float 1
windowrule = match:class ^(blueman-manager|trackma-gtk|pavucontrol|waydroid)$, float 1
windowrule = match:class ^(Signal|AppImageLauncher|wihotspot|zenity|syncplay)$, float 1
windowrule = match:title ^(branchdialog|KDE Connect URL handler|Network Manager|Quickshell Settings)$, float 1
windowrule = match:class ^(firefox)$, match:title ^(Extension:.*)$, float 1

# Misc
workspace = special:drop, on-created-empty:terminal --drop
windowrule = match:class ^(hyprland-share-picker)$, pin 1

# Picture-in-Picture
windowrule = match:title ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture).*$, pin 1
windowrule = match:title ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture).*$, float 1
windowrule = match:title ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture).*$, border_size 0
windowrule = match:title ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture).*$, no_initial_focus 1
windowrule = match:title ^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture).*$, keep_aspect_ratio 1

# Dialog Windows
windowrule = match:title ^(Open File|Select a File|Choose wallpaper|Open Folder|Save As|Library|File|Confirm).*$, float 1
windowrule = match:title ^(Open File|Select a File|Choose wallpaper|Open Folder|Save As|Library|File|Confirm).*$, center 1

windowrule = match:title ^(quickshell)$, tile 1
windowrule = match:class ^(org.gnome.Nautilus)$, tile 1

# Media / Aspect
windowrule = match:class ^(mpv)$, keep_aspect_ratio 1

# Idle Inhibit
windowrule = match:class ^(com.usebottles.bottles|Bottles)$, idle_inhibit fullscreen
windowrule = match:class ^(firefox)$, idle_inhibit fullscreen
windowrule = match:title ^(Picture-in-Picture)$, idle_inhibit always

# Size / Move / Workspace
windowrule = match:title ^(Calculator)$, size 360 540
windowrule = match:title ^(Dialect)$, size 1000 450
windowrule = match:title ^(Volume Control)$, size 575 565
windowrule = match:title ^(Volume Control)$, move 1320 490
windowrule = match:title ^(Volume Control)$, workspace special:pavu

# Visual Tweaks
windowrule = match:class ^(org.gnome.Loupe)$, border_size 0

# (This rule was invalid / useless before — removed)
# windowrule = noblur,class ^()$,title ^()$

windowrule = match:title ^(Find.*)$, move onscreen cursor
windowrule = match:title ^(Rename.*)$, float 1
windowrule = match:title ^(Question.*)$, stay_focused 1

# Tearing / Immediate
windowrule = match:title .*\.exe$, immediate 1
windowrule = match:title .*minecraft.*, immediate 1
windowrule = match:class ^(steam_app).*, immediate 1

# No shadow for tiled windows
windowrule = match:float 0, no_shadow on

#windowrule = match:class .*, opacity 0.89 0.89 override
#windowrule = match:class ^(thunar|geany|org.pwmt.zathura|sioyek|pavucontrol|org.telegram.desktop|discord|vesktop|WebCord|Spotify|quickshell)$, opacity 0.85 0.85
#windowrule = match:title ^(Find)$, opacity 0.75 0.75
