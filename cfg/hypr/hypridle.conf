$lock_cmd = hyprctl dispatch global quickshell:lock & pidof qs quickshell hyprlock 
$suspend_cmd = [[ $(cat /sys/class/power_supply/BAT*/status) != "Charging" ]] && systemctl suspend

general {
	lock_cmd = lockscreen
	inhibit_sleep = 3
	before_sleep_cmd = loginctl lock-session     # lock before suspend.
	after_sleep_cmd = hyprctl dispatch global quickshell:lockFocus
}

listener {
	timeout = 60
	on-timeout = if pgrep hyprlock; then hyprctl dispatch dpms off;fi
	on-resume = hyprctl dispatch dpms on
}

listener {
	timeout = 300
	on-timeout = if [[ "$(brightnessctl -m | cut -d "," -f4 | tr -d "%")" -ge "20" ]]; then brightnessctl s 20%- ;fi
	on-resume = if [[ "$(brightnessctl -m | cut -d "," -f4 | tr -d "%")" -ge "20" ]]; then brightnessctl s 20%+ ;fi
}

listener {
	timeout = 600
	on-timeout = loginctl lock-session
	on-resume = hyprctl dispatch dpms on
}

listener {
	timeout = 602
	on-timeout = hyprctl dispatch dpms off
	on-resume = hyprctl dispatch dpms on
}

listener {
    timeout = 1200
    on-timeout = $suspend_cmd
}
