#!/bin/bash

## Script to manage Volume Using Pamixer

# Dependencies: `pamixer` `notify-send`

icons="$HOME/.local/share/icons/Papirus/symbolic/status"
bar_color="$(xrdb -get color13)"

# Get Volume
get_volume() {
	volume=$(pamixer --get-volume)
	echo "$volume%"
}

get_icon() {
	volume="$(get_volume)"
	current="${volume%%%}"
	echo $current
	if [[ ("$current" -ge "0") && ("$current" -le "20") ]]; then
		icon="$icons/audio-volume-low-symbolic.svg"
	elif [[ ("$current" -ge "20") && ("$current" -le "40") ]]; then
		icon="$icons/audio-volume-low-symbolic.svg"
	elif [[ ("$current" -ge "40") && ("$current" -le "60") ]]; then
		icon="$icons/audio-volume-medium-symbolic.svg"
	elif [[ ("$current" -ge "60") && ("$current" -le "100") ]]; then
		icon="$icons/audio-volume-high-symbolic.svg"
	fi
}

notify(){
	if [[ "$XDG_SESSION_TYPE" == "x11" ]]; then 
		notify-send -a "Volume" -t 500 -r 69 -h string:x-dunst-stack-tag:volume_notif -h int:value:$(get_volume) -h string:hlcolor:$bar_color "$1"
	else
		ags run-js 'indicator.popup(1);'
    fi
}

# Increase Volume
inc_volume() {
	pamixer -u -i 5 && notify "Volume: $(get_volume)"
}

# Decrease Volume
dec_volume() {
	pamixer -u -d 5 && notify "Volume: $(get_volume)"
}

# Toggle Mute
toggle_mute() {
	if [[ "$(pamixer --get-mute)" == "false" ]]; then
		pamixer -t && notify-send -a "Volume" -t 1000 -r 69 "  Mute"
	else
		pamixer -t && notify-send -a "Volume" -t 1000 -r 69 "  $(get_volume)"
	fi
}

# Command-line argument handling
case "$1" in
    "--get")
	    get_volume
    ;;
	"--inc")
    	inc_volume
    ;;
	"--dec")
    	dec_volume
    ;;
	"--toggle")
    	toggle_mute
    ;;
	"")
    	get_volume
    ;;
    "--help" | "-h")
    echo "Usage: ${0##*/} [options] [--]
	Options:
	--help		Display this message
	--toggle	Toggle Mute
	--get   	Display the current volume
	--inc  		Increase the volume by 5%
	--dec		Decrease the volume by 5%"
    ;;
    *)
        echo "Invalid option. Use --help for usage instructions."
        exit 1
    ;;
esac
